---
layout: post
title: A Look at Defence In Depth
date:   2020-10-31
categories: ["Architecture"]
tags: ["Architecture", "Security", "Defence in Depth"]
author: ["Oskar Edbro"]
---

Far to often organisations do all their security work on the few systems that are exposed to the internet. This might be acceptable when you begin the  structured and ongoing work with security, but you should try to move on to defence in depth as soon as possible. 

Defence in depth is where you do not leave security to one layer of an application (or solution), but instead validate the security every step of the way. A common example for this is that even if you have a network firewall you do not disable the firewall in the operating system. This can be transferred to software development as well. In a more complex system each component should get the same security controls. It should not only be the frontend API that validates the input, instead each component should validate the data as untrusted when it receives it from another component. By doing so the resilience of the solution as a whole is greatly improved, where a single issue have limited impact, and might not even be exploitable.

## Example application and its vulnerabilities.

Let us look at a simple system to exemplify potential vulnerabilities. This system is simplified and super minimalistic, but still shows several ways to attack components on the internal network. The application is a web shop exposed to the internet through a firewall. The web shop fetches prices and products from a database. To manage the prices and products employees uses another administrative interface. The administrative interface connects to the same database to update the web shop. In this example, only the web shop is accessible from the internet, and the employee workstation is the only component with unrestricted access to the internet. 

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="576px" height="270px" viewBox="-0.5 -0.5 576 270" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-10-31T09:55:50.098Z&quot; agent=&quot;5.0 (Windows)&quot; etag=&quot;hefZqKikb7amuRyz3COV&quot; version=&quot;13.8.8&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;heWX10R3E39qh_TbpZ4s&quot; name=&quot;Page-1&quot;&gt;7VrZbuM2FP0aP1bQYi1+TGynU2CKBk0xmXkKaImW2KFElaK3+fpeSpS1UHacjpdOWgSIySuu59x7dEl75EzT7c8c5cmvLMJ0ZJvRduTMRrZtmU4AH9KyqyzjiVUZYk4i1agxPJFvuO6prCsS4aLTUDBGBcm7xpBlGQ5Fx4Y4Z5tusyWj3VlzFGPN8BQiqlufSSSSyhrYfmP/gEmc1DNb3qR6kqK6sdpJkaCIbVomZz5yppwxUZXS7RRTCV6NS9Xv4cDT/cI4zsQpHdxFuo39u4e/7K37afHb9PeX3eYnV61N7OoN4wj2r6qMi4TFLEN03ljvOVtlEZajmlBr2nxkLAejBcY/sRA7RSZaCQamRKRUPa3mlBMd3IoyFWzFQ3xk/bVLIB5jcaSdvQccPBWzFAu+g34cUyTIursOpFwm3rdrUIWCAvYNIKtx14iu1Ewa6qjIK+9dkq2E9j7HnMDsmIMNpgB3x4+NqY0moiTOoBwCeOWzvaNJeiJUJHuuihyFJIv/KHlywEDS0v3rzxlJY9ghJQv4j0KJzEtEOKyMSRgeiJwhw+IlpGwVGcU63rO5xlzg7XE+dfxVBy9QMaJEwnbGhtKNTRN0lqNaJa2ACyxjcinaTI2mKwQH3hLxuVX+IocyXFWbbdXIZWVXVzLY7+d2pdVLVptuZa3ud8ZAtE8MxAOOcKVAtG7JqNlh1D5O6Q2o8W5Jjf1eNHIJ5Q2iVKnjEpb1SQ0tyx8678DvUk3X66mmbRqOLpueb7ieLpyWZRq+e6lA828SaLUMWm+TwbLW8pxzB6B3qjaObxmB3usRmLMyA5ivAYJC4Xw4klrMFIKzr3jKKJPwZiyTfC8JpbVpZDuuKf/ATtEC00dWEEFYJ2hltBBIzT/2GiyYECxtNbhT4S6k49yzlaAkg9nrE4J5QBFyuU1ARp5kDLZckhAbcK4IcS4KY4MXMCE+T+iOK6r3oWv5lha37kQP2vGlcp3gpvHaS1v8K+Yt/g9xgLjJMW04b3klE4XKBZX0VLYs55Z0+f8klzmrtJ5bQjW17Gm3aVpBMBtQ0bQIETbKXjknBTY2jH8tBJLTwimSSA84v5w6zoCcDhwea9v5A9a7rZ42Kc+X9rMb5T9VNF4jASq73nGOdq0GZWgVrZEfpaHxHjuYdPNot3eR9rb2UKhW0LjPfivf4VHO/+nZ1dIz2+3pie0YvqYo3jUTtFrhjvFf0VhfU9s9jnsALinbhAniwoiQQAtUSOw2CWD4BCdg2XID7c6FZzdiLM/T0RzQZ+9i+hxoaM5qFPqowrbFK7cJfcdOSRRVko4L8g0tyqHM+i1fbsa9H7nyhSlVvKgE/UzXAn3ntcY62P4A2PbFwJ4MuK5HJagRWUMxlsVnCOAEBEE9gZlaD394UsZmYLj/LlrqgY/T8qCus94pL9odmmmepEyXY2XoyyKNlV/UFzGHWNE61KYF71veGaG+pV2KaoQOHQWcixE6dLOt8XMXpSQj8AKv8txTaS39YClf1/8VfiER7aZm9R12i9/JVfkdSsw1ouZpTtkOn87sc3NOfqdMjk2n90p0Ap3L4DxcQrX5pUV1Jmt+r+LM/wY=&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><path d="M 445 129.8 L 418.8 129.8 L 398.93 129.8" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 393.68 129.8 L 400.68 126.3 L 398.93 129.8 L 400.68 133.3 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><image x="444.5" y="88.3" width="130" height="81.9" xlink:href="https://app.diagrams.net/img/lib/active_directory/internet_cloud.svg"/><path d="M 392.56 129.75 L 438.63 129.75" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 443.88 129.75 L 436.88 133.25 L 438.63 129.75 L 436.88 126.25 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 328.56 105.03 L 208.5 105 L 208.5 80.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 208.5 75.12 L 212 82.12 L 208.5 80.37 L 205 82.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><image x="324.5" y="73.88" width="67.56" height="110.75" xlink:href="https://app.diagrams.net/img/lib/active_directory/firewall.svg" transform="translate(358.78,0)scale(-1,1)translate(-358.78,0)"/><path d="M 179 49.5 L 131.5 49.5 L 131.5 50 L 90.37 50" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 85.12 50 L 92.12 46.5 L 90.37 50 L 92.12 53.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="179" y="25" width="59" height="49" fill="none" stroke="none" pointer-events="all"/><path d="M 228.78 46.76 C 230.64 47.43 232 48.41 233.15 49.51 C 232.5 49.89 231.81 50.23 231 50.55 C 230.19 48.62 229.47 47.58 228.78 46.76 Z M 231.59 51.96 C 232.57 51.55 233.49 51.1 234.35 50.56 C 236.34 52.83 236.79 54.36 237.31 55.8 C 235.91 56.76 234.43 57.59 232.79 58.09 C 232.61 56.23 232.35 54.3 231.59 51.96 Z M 232.81 59.54 C 234.69 58.99 236.28 58.24 237.59 57.33 C 238 59.89 237.82 61.43 237.54 62.79 C 235.42 64.37 233.75 65.06 232.12 65.67 C 232.34 64.37 232.56 64.97 232.81 59.54 Z M 231.64 67.48 C 233.15 67.01 234.66 66.5 236.88 65.09 C 234.92 69.74 231.55 72.14 228.59 73.16 C 229.67 71.96 230.72 70.48 231.64 67.48 Z M 229.88 67.94 C 228.43 71.78 226.34 73.52 224.54 73.93 L 224.54 68.65 C 226.39 68.61 228.18 68.38 229.88 67.94 Z M 224.53 67.22 L 224.53 61.08 C 226.34 61.13 228.72 60.72 231.29 60.15 C 231.3 62.75 230.91 64.58 230.49 66.35 C 228.09 66.99 226.25 67.16 224.53 67.22 Z M 224.62 59.54 L 224.62 53.31 C 226.51 53.21 228.38 52.95 230.18 52.42 C 230.79 54.21 231.13 56.35 231.37 58.57 C 229.29 59.17 227.02 59.45 224.62 59.54 Z M 224.47 45.89 L 225.05 45.89 C 226.39 46.33 227.34 47.39 227.88 48.07 C 228.7 49.1 229.15 50.06 229.58 51 C 228.21 51.39 226.61 51.74 224.46 51.82 Z M 223.05 51.89 C 221.35 51.82 219.67 51.54 218.02 51.07 C 218.57 49.71 219.29 48.47 220.27 47.42 C 220.86 46.82 221.52 46.28 222.46 45.96 L 223.05 45.96 Z M 223.13 59.55 C 220.58 59.45 218.34 59.12 216.37 58.57 C 216.5 56.78 216.55 55.09 217.56 52.42 C 219.77 53.11 222.34 53.32 223.14 53.3 Z M 223.05 61.02 L 223.06 67.16 C 221.1 67.22 219.15 66.89 217.18 66.38 C 216.57 64.2 216.3 62.1 216.31 60.08 C 218.52 60.68 220.78 60.97 223.05 61.02 Z M 223.05 68.73 L 223.05 74 C 222 73.77 221.12 73.21 220.36 72.43 C 219.13 71.18 218.31 69.66 217.7 68.15 C 219.48 68.5 221.25 68.77 223.05 68.73 Z M 215.98 67.6 C 216.98 70.67 218.05 71.97 219.12 73.2 C 214.44 71.44 212.16 68.23 210.89 65.5 C 212.56 66.36 214.21 67.22 215.98 67.6 Z M 210.12 63.23 C 209.66 61.56 209.53 59.63 209.92 57.32 C 211.27 58.15 212.79 58.95 214.8 59.62 C 214.79 61.87 215.02 63.95 215.47 65.83 C 214 65.42 212.32 64.69 210.12 63.23 Z M 210.36 55.82 C 210.98 53.76 212 52.04 213.34 50.56 C 214.3 51.22 215.18 51.55 216.08 51.96 C 215.34 53.99 215.01 56.24 214.89 58.11 C 213.46 57.61 212.03 57.07 210.36 55.82 Z M 214.36 49.45 C 215.89 48.16 217.37 47.31 218.83 46.76 C 218.09 47.63 217.32 48.76 216.53 50.48 C 215.71 50.14 214.98 49.79 214.36 49.45 Z M 227.4 44.02 L 227.4 32.43 L 181.23 32.43 L 181.23 62.22 C 181.23 62.71 181.62 62.95 181.95 62.95 L 207.56 62.95 C 207.74 63.9 207.94 64.54 208.15 65.18 L 181.87 65.18 C 180.33 65.18 179 63.75 179 62.31 L 179 27.98 C 179 26 180.74 25 181.83 25 L 226.58 25 C 228.3 25 229.63 26.29 229.63 28.03 L 229.63 44.71 C 228.95 44.45 228.19 44.18 227.4 44.02 Z M 227.4 29.46 L 227.4 27.22 L 225.16 27.22 L 225.16 29.46 Z M 199.85 59.22 L 199.85 53.27 L 203.57 53.27 L 203.57 48.81 L 193.89 48.81 L 193.89 53.27 L 197.61 53.27 L 197.61 59.22 L 188.68 59.22 L 188.68 53.27 L 192.4 53.27 L 192.4 47.32 L 203.57 47.32 L 203.57 42.84 L 199.11 42.84 L 199.11 36.15 L 209.53 36.14 L 209.53 42.84 L 205.06 42.84 L 205.06 47.32 L 213.27 47.32 C 212.71 47.76 212.2 48.25 211.71 48.81 L 205.06 48.81 L 205.06 53.27 L 208.72 53.27 C 207.85 55.09 207.39 57.29 207.3 59.22 Z M 222.93 29.46 L 222.93 27.22 L 220.7 27.22 L 220.7 29.46 Z M 218.47 29.46 L 218.47 27.22 L 216.24 27.22 L 216.24 29.46 Z" fill="#000000" stroke="none" pointer-events="all"/><path d="M 229 210 L 277 210 L 277 154.5 L 322.19 154.49" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 327.44 154.48 L 320.44 157.99 L 322.19 154.49 L 320.44 150.99 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 179 210 L 133.5 210 L 133.5 202.2 L 94.37 202.2" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 89.12 202.2 L 96.12 198.7 L 94.37 202.2 L 96.12 205.7 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="179" y="185" width="50" height="50" fill="none" stroke="none" pointer-events="all"/><path d="M 179 235 L 179 187.4 C 179.05 186.1 180.1 185.05 181.41 185 L 201.06 185 C 202.33 185.1 203.32 186.13 203.37 187.4 L 203.37 200.83 L 192.94 200.83 C 191.42 201.19 190.24 202.4 189.93 203.94 L 189.93 222.78 L 182.61 222.78 L 182.61 225.18 L 189.93 225.18 C 189.91 226.01 190.01 226.84 190.23 227.59 L 182.61 227.59 L 182.61 230.09 L 200.46 229.99 C 198.26 230.23 196.64 232.42 196.85 234.9 Z M 182.61 194.77 L 199.76 194.77 L 199.76 192.31 L 182.61 192.31 Z M 192.39 204.74 C 192.41 203.95 193.05 203.31 193.84 203.29 L 227.44 203.29 C 227.83 203.29 228.22 203.44 228.5 203.73 C 228.78 204.01 228.94 204.39 228.94 204.79 L 228.94 225.88 C 229 226.31 228.87 226.75 228.58 227.08 C 228.29 227.4 227.87 227.59 227.44 227.59 L 213.1 227.59 L 213.1 230.24 C 213.37 230.94 213.86 231.54 214.5 231.94 C 215.97 231.92 217.45 231.98 218.91 232.14 C 219.91 232.18 220.86 232.51 221.67 233.1 C 221.95 233.37 222.06 233.86 221.93 234.29 C 221.8 234.72 221.46 234.97 221.12 234.9 L 217.66 234.9 L 213.95 233.8 L 206.78 233.8 L 203.87 234.9 L 199.86 234.9 C 199.53 234.76 199.3 234.45 199.26 234.1 C 199.34 233.46 199.76 232.93 200.36 232.7 C 201.18 232.32 202.07 232.1 202.97 232.04 L 206.68 231.94 C 207.57 231.48 208.18 230.59 208.28 229.59 L 208.28 227.59 L 193.84 227.59 C 193.42 227.56 193.03 227.36 192.77 227.04 C 192.5 226.72 192.38 226.3 192.44 225.88 Z M 196.05 206.89 L 196.05 223.93 L 225.33 223.93 L 225.33 206.89 Z" fill="#000000" stroke="none" pointer-events="all"/><path d="M 53.5 177.7 L 53.5 104 L 53.87 86.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 53.98 81.12 L 57.33 88.19 L 53.87 86.37 L 50.33 88.04 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="19" y="177.7" width="69" height="49" fill="none" stroke="none" pointer-events="all"/><path d="M 77.21 199.46 C 79.4 200.13 80.99 201.11 82.32 202.21 C 81.57 202.59 80.76 202.93 79.81 203.25 C 78.86 201.32 78.03 200.28 77.21 199.46 Z M 80.5 204.66 C 81.65 204.25 82.73 203.8 83.73 203.26 C 86.06 205.53 86.58 207.06 87.19 208.5 C 85.55 209.46 83.82 210.29 81.9 210.79 C 81.7 208.93 81.39 207 80.5 204.66 Z M 81.93 212.24 C 84.13 211.69 85.99 210.94 87.52 210.03 C 88 212.59 87.79 214.13 87.47 215.49 C 84.98 217.07 83.03 217.76 81.13 218.37 C 81.38 217.07 81.64 217.67 81.93 212.24 Z M 80.56 220.18 C 82.32 219.71 84.1 219.2 86.69 217.79 C 84.4 222.44 80.45 224.84 76.99 225.86 C 78.26 224.66 79.49 223.18 80.56 220.18 Z M 78.5 220.64 C 76.81 224.48 74.37 226.22 72.26 226.63 L 72.26 221.35 C 74.43 221.31 76.52 221.08 78.5 220.64 Z M 72.24 219.92 L 72.24 213.78 C 74.37 213.83 77.14 213.42 80.15 212.85 C 80.16 215.45 79.71 217.28 79.22 219.05 C 76.41 219.69 74.25 219.86 72.24 219.92 Z M 72.35 212.24 L 72.35 206.01 C 74.57 205.91 76.75 205.65 78.85 205.12 C 79.57 206.91 79.97 209.05 80.24 211.27 C 77.82 211.87 75.16 212.15 72.35 212.24 Z M 72.18 198.59 L 72.86 198.59 C 74.43 199.03 75.53 200.09 76.17 200.77 C 77.12 201.8 77.66 202.76 78.15 203.7 C 76.55 204.09 74.68 204.44 72.16 204.52 Z M 70.51 204.59 C 68.53 204.52 66.57 204.24 64.63 203.77 C 65.28 202.41 66.11 201.17 67.26 200.12 C 67.96 199.52 68.73 198.98 69.83 198.66 L 70.51 198.66 Z M 70.61 212.25 C 67.62 212.15 65.01 211.82 62.7 211.27 C 62.85 209.48 62.91 207.79 64.09 205.12 C 66.68 205.81 69.69 206.02 70.62 206 Z M 70.51 213.72 L 70.53 219.86 C 68.24 219.92 65.95 219.59 63.65 219.08 C 62.93 216.9 62.62 214.8 62.63 212.78 C 65.22 213.38 67.86 213.67 70.51 213.72 Z M 70.51 221.43 L 70.51 226.7 C 69.28 226.47 68.26 225.91 67.37 225.13 C 65.93 223.88 64.98 222.36 64.26 220.85 C 66.34 221.2 68.41 221.47 70.51 221.43 Z M 62.25 220.3 C 63.42 223.37 64.66 224.67 65.92 225.9 C 60.45 224.14 57.78 220.93 56.29 218.2 C 58.24 219.06 60.18 219.92 62.25 220.3 Z M 55.4 215.93 C 54.85 214.26 54.7 212.33 55.17 210.02 C 56.75 210.85 58.52 211.65 60.87 212.32 C 60.86 214.57 61.12 216.65 61.66 218.53 C 59.94 218.12 57.96 217.39 55.4 215.93 Z M 55.68 208.52 C 56.4 206.46 57.59 204.74 59.16 203.26 C 60.29 203.92 61.31 204.25 62.36 204.66 C 61.49 206.69 61.11 208.94 60.97 210.81 C 59.3 210.31 57.63 209.77 55.68 208.52 Z M 60.36 202.15 C 62.14 200.86 63.87 200.01 65.58 199.46 C 64.71 200.33 63.82 201.46 62.89 203.18 C 61.93 202.84 61.08 202.49 60.36 202.15 Z M 75.6 196.72 L 75.6 185.13 L 21.61 185.13 L 21.61 214.92 C 21.61 215.41 22.07 215.65 22.45 215.65 L 52.4 215.65 C 52.61 216.6 52.84 217.24 53.09 217.88 L 22.36 217.88 C 20.56 217.88 19 216.45 19 215.01 L 19 180.68 C 19 178.7 21.03 177.7 22.31 177.7 L 74.65 177.7 C 76.66 177.7 78.21 178.99 78.21 180.73 L 78.21 197.41 C 77.41 197.15 76.53 196.88 75.6 196.72 Z M 75.6 182.16 L 75.6 179.92 L 72.99 179.92 L 72.99 182.16 Z M 43.38 211.92 L 43.38 205.97 L 47.74 205.97 L 47.74 201.51 L 36.42 201.51 L 36.42 205.97 L 40.77 205.97 L 40.77 211.92 L 30.32 211.92 L 30.32 205.97 L 34.67 205.97 L 34.67 200.02 L 47.74 200.02 L 47.74 195.54 L 42.52 195.54 L 42.52 188.85 L 54.7 188.84 L 54.7 195.54 L 49.48 195.54 L 49.48 200.02 L 59.08 200.02 C 58.43 200.46 57.82 200.95 57.26 201.51 L 49.48 201.51 L 49.48 205.97 L 53.76 205.97 C 52.74 207.79 52.21 209.99 52.1 211.92 Z M 70.38 182.16 L 70.38 179.92 L 67.76 179.92 L 67.76 182.16 Z M 65.16 182.16 L 65.16 179.92 L 62.55 179.92 L 62.55 182.16 Z" fill="#000000" stroke="none" pointer-events="all"/><path d="M 24 70 L 24 30 C 24 24.48 37.43 20 54 20 C 70.57 20 84 24.48 84 30 L 84 70 C 84 75.52 70.57 80 54 80 C 37.43 80 24 75.52 24 70 Z" fill="#ffffff" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 24 30 C 24 35.52 37.43 40 54 40 C 70.57 40 84 35.52 84 30" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="19" y="0" width="70" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 54px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Database</div></div></div></foreignObject><text x="54" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Database</text></switch></g><rect x="173.5" y="0" width="70" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 209px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><div>Webshop</div></div></div></div></foreignObject><text x="209" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Webshop</text></switch></g><rect x="325" y="54" width="60" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 64px; margin-left: 355px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><div>Firewall</div></div></div></div></foreignObject><text x="355" y="68" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Firewall</text></switch></g><rect x="475" y="74" width="50" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 89px; margin-left: 500px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><div>Internet</div><div><br /></div></div></div></div></foreignObject><text x="500" y="93" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Internet&#xa;</text></switch></g><rect x="0" y="229" width="90" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 244px; margin-left: 45px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><div>Administrative</div><div>Interface<br /></div></div></div></div></foreignObject><text x="45" y="248" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Administrative...</text></switch></g><rect x="168.5" y="239" width="80" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 254px; margin-left: 209px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><div>Employee</div><div>Workstation</div></div></div></div></foreignObject><text x="209" y="258" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Employee...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>

Let's take a look at a couple of ways this architecture potentially could be exploited and how defence in depth could reduce the impact of these vulnerabilities.

### Infecting the Workstation
The most obvious way into the network is to infect the employee workstation. This can for example be done by using trojans through emails or public exploits in the operating system. Regardless of how the initial attack is performed, the goal is the same, hijacking the employee workstation to get access to the internal network. To mitigate this it is important to include the workstations in the security policy of the organisation. For example the software on the workstation needs to be up to date with the latest security patches. 

In addition to patches, using a good antivirus software will keep a lookout for malicious code on the computer, helping users to distinguish trojans from legitimate files and programs. As an added bonus, the antivirus will log incidents, ensuring that the organisation is aware of failed attacks, and can investigate suspicious activities. 

These technical solutions might however not be enough. To circumvent patched software and antivirus the most dedicated attackers might hack the employee instead of the workstation. This can be done in multiple ways. Some examples include social engineering and bribery. Whatever the way the best way to protect the organisation against these attacks is through security awareness training. By getting the employees to be on the lookout for and report suspicious activities most of these attacks will fail.

### Through the Web shop
Organisations are now getting quite good at securing their web applications against attacks that affect their corporate networks. However, there are a couple ways a vulnerable webserver can be abused to gain a foothold and enter the network. In my experience the two most common are components with known vulnerabilities, or administrative interfaces exposed to the internet. Note that these administrative interfaces might be anything from a WordPress admin interface to a SSH server. Neither of which is weak if configured correctly, but far to often they have accounts that can be bruteforced, allowing an attacker to try different credentials until they successfully sign in. The goal of this is to gain access to the solution and then get further access into the corporate network. 

Another possibility is to circumvent the webserver and just attack the network directly. This can for example be done by using a SQL-injection or server-side request forgery. An SQL-injection would allow the attacker to execute database commands in the database through the web application, attacking it directly. A server-side request forgery is a vulnerability that abuses a server to make requests against other applications. This means that the attacker can attack any system that the server can connect to, including on the internal network.

### Vulnerabilities in the Administrative Interface
There are multiple vulnerabilities that can occur in web applications that could be exploited from the internet, even though the application is not accessible. These vulnerabilities uses a legitimate user of the internal application to perform the attack. Attacks that can be exploited could be clickjacking or cross-site request forgery. Both of which rely on a legitimate authenticated user of the vulnerable system visiting a malicious webpage on the internet. While the user thinks they are visiting this webpage on the internet, the attacker is using their browser to send requests to the internal systems, signed in as the victim. The result of this attack can range from the attacker being able to perform actions as the victim, to them being able to exploit other vulnerabilities with an even greater impact.

There are ways to protect against these attacks, but since they exists it is important to not forget these internal systems in regards to security. They should not be allowed to ignore the security recommendations just because they are not exposed to the internet.

## Conclusion
There are multiple ways for an attacker to gain access into the internal network of an organisation without them being accessible from nor have access to the internet. Therefore it is important to include all systems in the security work. No systems should be excused because they are not exposed to the internet, you never know how an attacker can gain access to them.

When looking at a more complex system than this, other and more complex attacks emerges, but the conclusion is the same. Do your due diligence for the security of the solution, not only focusing on the exposed parts, but also on the components behind it.
